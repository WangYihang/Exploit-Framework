#!/usr/bin/env python
# encoding: utf-8

import importlib
from core.api.cli.base import BaseCommand

class Command(BaseCommand):

	def __init__(self, context):
		self.context = context

	def help(self):
		print "Help of Use"

	def description(self):
		print "Desc of Use"

	def run(self, *argc, **argkv):
		if len(argc) != 1:
			self.help()
			return

		category = argc[0].split(".")[0]
		name = argc[0].split(".")[1]
		vender = argc[0].split(".")[2]
		exploit = argc[0].split(".")[3]
		path = "%s.%s.%s.%s" % (category, name, vender, exploit)

		try:
			module = importlib.import_module(path)
			exploit_instance = module.Exploit()
			self.context["instance"] = exploit_instance
		except Exception as e:
			print(repr(e))